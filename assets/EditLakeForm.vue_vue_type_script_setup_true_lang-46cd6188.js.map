{"version":3,"file":"EditLakeForm.vue_vue_type_script_setup_true_lang-46cd6188.js","sources":["../../src/pages/lakes/widgets/EditLakeForm.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { PropType, computed, ref, watch } from 'vue'\nimport { useForm } from 'vuestic-ui'\nimport { Lake } from '../types'\nimport UserAvatar from './UserAvatar.vue'\nimport { useProjects } from '../../projects/composables/useProjects'\nimport { validators } from '../../../services/utils'\n\nconst props = defineProps({\n  lake: {\n    type: Object as PropType<Lake | null>,\n    default: null,\n  },\n  saveButtonLabel: {\n    type: String,\n    default: 'Save',\n  },\n})\n\nconst defaultNewLake: Lake = {\n  id: 1,\n  englishName: \"\",\n  droneShots: [],\n  geoTag: \"\",\n  gujaratiName: \"\",\n  village: \"\",\n  dimensions: \"\",\n  partner: \"\",\n  startDate: \"\",\n  endDate: \"\",\n  capacity: \"\",\n  projectHead: \"\",\n  projectHeadContact: \"\",\n  supervisor: \"\",\n  supervisorContact: \"\",\n  fs: false,\n  ss: false,\n  wsi: false,\n  prc: false,\n  ha: false,\n  cg: false,\n  ec: false,\n  ls: false,\n  fwm: false,\n  sd: false,\n  mm: false\n}\n\nconst newLake = ref<Lake>({ ...defaultNewLake })\n\nconst isFormHasUnsavedChanges = computed(() => {\n  return Object.keys(newLake.value).some((key) => {\n    if (key === 'avatar' || key === 'projects') {\n      return false\n    }\n\n    return newLake.value[key as keyof Lake] !== (props.lake ?? defaultNewLake)?.[key as keyof Lake]\n  })\n})\n\ndefineExpose({\n  isFormHasUnsavedChanges,\n})\n\nwatch(\n  () => props.user,\n  () => {\n    if (!props.user) {\n      return\n    }\n\n    newUser.value = {\n      ...props.user,\n      avatar: props.user.avatar || '',\n    }\n  },\n  { immediate: true },\n)\n\nconst avatar = ref<File>()\n\nconst makeAvatarBlobUrl = (avatar: File) => {\n  return URL.createObjectURL(avatar)\n}\n\nwatch(avatar, (newAvatar) => {\n  newUser.value.avatar = newAvatar ? makeAvatarBlobUrl(newAvatar) : ''\n})\n\nconst form = useForm('add-user-form')\n\nconst emit = defineEmits(['close', 'save'])\n\nconst onSave = () => {\n  if (form.validate()) {\n    emit('save', newUser.value)\n  }\n}\n\nconst roleSelectOptions: { text: Capitalize<UserRole>; value: UserRole }[] = [\n  { text: 'Admin', value: 'admin' },\n  { text: 'User', value: 'user' },\n  { text: 'Owner', value: 'owner' },\n]\n\nconst { projects } = useProjects({ pagination: ref({ page: 1, perPage: 9999, total: 10 }) })\n</script>\n\n<template>\n  <VaForm v-slot=\"{ isValid }\" ref=\"add-user-form\" class=\"flex-col justify-start items-start gap-4 inline-flex w-full\">\n    <div class=\"self-stretch flex-col justify-start items-start gap-4 flex\">\n      <div class=\"flex gap-4 flex-col md:flex-row w-full\">\n        <VaInput\n          v-model=\"newLake.englishName\"\n          label=\"Lake name in English\"\n          class=\"w-full md:w-1/2\"\n          :rules=\"[validators.required]\"\n          name=\"englishName\"\n        />\n        <VaInput\n          v-model=\"newLake.gujaratiName\"\n          label=\"Lake name in Gujarati\"\n          class=\"w-full md:w-1/2\"\n          :rules=\"[validators.required]\"\n          name=\"gujaratiName\"\n        />\n      </div>\n      <div class=\"flex gap-4 flex-col md:flex-row w-full\">\n        <VaInput\n          v-model=\"newLake.geoTag\"\n          label=\"Geo Tag\"\n          class=\"w-full md:w-full\"\n          :rules=\"[validators.required]\"\n          name=\"geoTag\"\n        />\n      </div>\n      <div class=\"flex gap-4 flex-col md:flex-row w-full\">\n        <VaInput\n          v-model=\"newLake.village\"\n          label=\"Village\"\n          class=\"w-full md:w-1/2\"\n          :rules=\"[validators.required]\"\n          name=\"village\"\n        />\n        <VaInput\n          v-model=\"newLake.dimensions\"\n          label=\"Dimensions\"\n          class=\"w-full md:w-1/2\"\n          :rules=\"[validators.required]\"\n          name=\"dimensions\"\n        />\n      </div>\n      <div class=\"flex gap-4 flex-col md:flex-row w-full\">\n        <VaInput\n          v-model=\"newLake.partner\"\n          label=\"Partner\"\n          class=\"w-full md:w-1/2\"\n          :rules=\"[validators.required]\"\n          name=\"partner\"\n        />\n        <VaInput\n          v-model=\"newLake.capacity\"\n          label=\"Capacity\"\n          class=\"w-full md:w-1/2\"\n          :rules=\"[validators.required]\"\n          name=\"capacity\"\n        />\n      </div>\n      <div class=\"flex gap-4 flex-col md:flex-row w-full\">\n        <VaDateInput\n          v-model=\"newLake.startDate\"\n          class=\"w-full md:w-1/2\"\n          label=\"Start Date\"\n          :rules=\"[validators.required]\"\n        />\n        <VaDateInput\n          v-model=\"newLake.endDate\"\n          class=\"w-full md:w-1/2\"\n          label=\"End Date\"\n          :rules=\"[validators.required]\"\n        />\n      </div>\n      <div class=\"flex gap-4 flex-col md:flex-row w-full\">\n        <VaInput\n          v-model=\"newLake.projectHead\"\n          label=\"Project Head\"\n          class=\"w-full md:w-1/2\"\n          :rules=\"[validators.required]\"\n          name=\"projectHead\"\n        />\n        <VaInput\n          v-model=\"newLake.projectHeadContact\"\n          label=\"Project Head Contact\"\n          class=\"w-full md:w-1/2\"\n          :rules=\"[validators.required]\"\n          name=\"projectHeadContact\"\n        />\n      </div>\n      <div class=\"flex gap-4 flex-col md:flex-row w-full\">\n        <VaInput\n          v-model=\"newLake.supervisor\"\n          label=\"Supervisor\"\n          class=\"w-full md:w-1/2\"\n          :rules=\"[validators.required]\"\n          name=\"supervisor\"\n        />\n        <VaInput\n          v-model=\"newLake.supervisorContact\"\n          label=\"Supervisor Contact\"\n          class=\"w-full md:w-1/2\"\n          :rules=\"[validators.required]\"\n          name=\"supervisorContact\"\n        />\n      </div>\n      <VaFileUpload\n        v-model=\"newLake.droneShots\"\n        type=\"gallery\"\n        dropzone\n        dropZoneText=\"Upload site files here\"\n        uploadButtonText=\"Upload files\"\n        file-types=\"image/*,video/*\"\n        label=\"Test\"\n      >\n      </VaFileUpload>\n\n      <div class=\"flex gap-2 flex-col-reverse items-stretch justify-end w-full sm:flex-row sm:items-center\">\n        <VaButton preset=\"secondary\" color=\"secondary\" @click=\"$emit('close')\">Cancel</VaButton>\n        <VaButton :disabled=\"!isValid\" @click=\"onSave\">{{ saveButtonLabel }}</VaButton>\n      </div>\n    </div>\n  </VaForm>\n</template>\n"],"names":["props","__props","defaultNewLake","newLake","ref","isFormHasUnsavedChanges","computed","key","_a","__expose","watch","avatar","makeAvatarBlobUrl","newAvatar","form","useForm","emit","__emit","onSave","useProjects"],"mappings":"q7BAQA,MAAMA,EAAQC,EAWRC,EAAuB,CAC3B,GAAI,EACJ,YAAa,GACb,WAAY,CAAC,EACb,OAAQ,GACR,aAAc,GACd,QAAS,GACT,WAAY,GACZ,QAAS,GACT,UAAW,GACX,QAAS,GACT,SAAU,GACV,YAAa,GACb,mBAAoB,GACpB,WAAY,GACZ,kBAAmB,GACnB,GAAI,GACJ,GAAI,GACJ,IAAK,GACL,IAAK,GACL,GAAI,GACJ,GAAI,GACJ,GAAI,GACJ,GAAI,GACJ,IAAK,GACL,GAAI,GACJ,GAAI,EAAA,EAGAC,EAAUC,EAAU,CAAE,GAAGF,CAAgB,CAAA,EAEzCG,EAA0BC,EAAS,IAChC,OAAO,KAAKH,EAAQ,KAAK,EAAE,KAAMI,GAAQ,OAC1C,OAAAA,IAAQ,UAAYA,IAAQ,WACvB,GAGFJ,EAAQ,MAAMI,CAAiB,MAAOC,EAAAR,EAAM,MAAQE,IAAd,YAAAM,EAAgCD,GAAiB,CAC/F,CACF,EAEYE,EAAA,CACX,wBAAAJ,CAAA,CACD,EAEDK,EACE,IAAMV,EAAM,KACZ,IAAM,CACCA,EAAM,OAIX,QAAQ,MAAQ,CACd,GAAGA,EAAM,KACT,OAAQA,EAAM,KAAK,QAAU,EAAA,EAEjC,EACA,CAAE,UAAW,EAAK,CAAA,EAGpB,MAAMW,EAASP,IAETQ,EAAqBD,GAClB,IAAI,gBAAgBA,CAAM,EAG7BD,EAAAC,EAASE,GAAc,CAC3B,QAAQ,MAAM,OAASA,EAAYD,EAAkBC,CAAS,EAAI,EAAA,CACnE,EAEK,MAAAC,EAAOC,EAAQ,eAAe,EAE9BC,EAAOC,EAEPC,EAAS,IAAM,CACfJ,EAAK,YACFE,EAAA,OAAQ,QAAQ,KAAK,CAC5B,EASmB,OAAAG,EAAY,CAAE,WAAYf,EAAI,CAAE,KAAM,EAAG,QAAS,KAAM,MAAO,EAAG,CAAC,EAAG"}