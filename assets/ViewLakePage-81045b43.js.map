{"version":3,"file":"ViewLakePage-81045b43.js","sources":["../../src/pages/lakes/widgets/LakeDetails.vue","../../src/pages/lakes/widgets/LakeChecklist.vue","../../src/pages/lakes/ViewLakePage.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { PropType, computed, ref, watch } from 'vue'\nimport { useForm, VaImage } from 'vuestic-ui'\nimport { Lake } from '../types'\nimport UserAvatar from './UserAvatar.vue'\nimport { useProjects } from '../../projects/composables/useProjects'\nimport { validators } from '../../../services/utils'\n\nconst props = defineProps({\n  lake: {\n    type: Object as PropType<Lake | null>,\n    default: null,\n  },\n  saveButtonLabel: {\n    type: String,\n    default: 'Save',\n  },\n})\n\nconst doShowMediaModal = ref(false)\n\nconst defaultNewLake: Lake = {\n  id: 1,\n  englishName: \"Lake 1\",\n  droneShots: [],\n  geoTag: \"https://www.google.com/maps/place/22%C2%B004'43.7%22N+80%C2%B020'58.7%22E/@22.078792,80.3470621,17z/data=!3m1!4b1!4m4!3m3!8m2!3d22.078792!4d80.349637?entry=ttu\",\n  gujaratiName: \"Abhishe\",\n  village: \"Village 1\",\n  dimensions: \"123 x 2324\",\n  partner: \"Bill Gates\",\n  startDate: \"March 23, 2023\",\n  endDate: \"September 03, 2024\",\n  capacity: \"234234\",\n  projectHead: \"Mark Zuckerberg\",\n  projectHeadContact: \"09464846545\",\n  supervisor: \"Elon Mask\",\n  supervisorContact: \"09451516554\",\n  fs: false,\n  ss: false,\n  wsi: false,\n  prc: false,\n  ha: false,\n  cg: false,\n  ec: false,\n  ls: false,\n  fwm: false,\n  sd: false,\n  mm: false\n}\n\nconst images = [\n  '/samples/sample-image1.jpg',\n  '/samples/sample-image2.jpg',\n  '/samples/sample-image3.jpg',\n  '/samples/sample-image4.jpg',\n  '/samples/sample-image5.jpg'\n]\n\nconst newLake = ref<Lake>({ ...defaultNewLake })\n\nconst isFormHasUnsavedChanges = computed(() => {\n  return Object.keys(newLake.value).some((key) => {\n    if (key === 'avatar' || key === 'projects') {\n      return false\n    }\n\n    return newLake.value[key as keyof Lake] !== (props.lake ?? defaultNewLake)?.[key as keyof Lake]\n  })\n})\n\ndefineExpose({\n  isFormHasUnsavedChanges,\n})\n\nwatch(\n  () => props.user,\n  () => {\n    if (!props.user) {\n      return\n    }\n\n    newUser.value = {\n      ...props.user,\n      avatar: props.user.avatar || '',\n    }\n  },\n  { immediate: true },\n)\n\nconst avatar = ref<File>()\n\nconst makeAvatarBlobUrl = (avatar: File) => {\n  return URL.createObjectURL(avatar)\n}\n\nwatch(avatar, (newAvatar) => {\n  newUser.value.avatar = newAvatar ? makeAvatarBlobUrl(newAvatar) : ''\n})\n\nconst form = useForm('add-user-form')\n\nconst emit = defineEmits(['close', 'save'])\n\nconst onSave = () => {\n  if (form.validate()) {\n    emit('save', newUser.value)\n  }\n}\n\nconst roleSelectOptions: { text: Capitalize<UserRole>; value: UserRole }[] = [\n  { text: 'Admin', value: 'admin' },\n  { text: 'User', value: 'user' },\n  { text: 'Owner', value: 'owner' },\n]\n\nconst { projects } = useProjects({ pagination: ref({ page: 1, perPage: 9999, total: 10 }) })\n\n</script>\n\n<template>\n  <div class=\"self-stretch flex-col justify-start items-start gap-4 flex\">\n    <div class=\"flex gap-4 flex-col md:flex-row w-full\">\n      <div class=\"w-full md:w-1/2\">\n        <label class=\"font-bold\">Lake name in English: </label>\n        {{ newLake.englishName }}\n      </div>\n      <div class=\"w-full md:w-1/2\">\n        <label class=\"font-bold\">Lake name in Gujarati: </label>\n        {{ newLake.gujaratiName }}\n      </div>\n    </div>\n    <div class=\"flex gap-4 flex-col md:flex-row w-full\">\n      <div class=\"w-full md:w-1/2\">\n        <label class=\"font-bold\">Village: </label>\n        {{ newLake.village }}\n      </div>\n      <div class=\"w-full md:w-1/2\">\n        <label class=\"font-bold\">Dimensions: </label>\n        {{ newLake.dimensions }}\n      </div>\n    </div>\n    <div class=\"flex gap-4 flex-col md:flex-row w-full\">\n      <div class=\"w-full md:w-1/2\">\n        <label class=\"font-bold\">Partner: </label>\n        {{ newLake.partner }}\n      </div>\n      <div class=\"w-full md:w-1/2\">\n        <label class=\"font-bold\">Capacity: </label>\n        {{ newLake.capacity }}\n      </div>\n    </div>\n    <div class=\"flex gap-4 flex-col md:flex-row w-full\">\n      <div class=\"w-full md:w-1/2\">\n        <label class=\"font-bold\">Start Date: </label>\n        {{ newLake.startDate }}\n      </div>\n      <div class=\"w-full md:w-1/2\">\n        <label class=\"font-bold\">End Date: </label>\n        {{ newLake.endDate }}\n      </div>\n    </div>\n    <div class=\"flex gap-4 flex-col md:flex-row w-full\">\n      <div class=\"w-full md:w-1/2\">\n        <label class=\"font-bold\">Project Head: </label>\n        {{ newLake.projectHead }}\n      </div>\n      <div class=\"w-full md:w-1/2\">\n        <label class=\"font-bold\">Project Head Contact: </label>\n        {{ newLake.projectHeadContact }}\n      </div>\n    </div>\n    <div class=\"flex gap-4 flex-col md:flex-row w-full\">\n      <div class=\"w-full md:w-1/2\">\n        <label class=\"font-bold\">Supervisor: </label>\n        {{ newLake.supervisor }}\n      </div>\n      <div class=\"w-full md:w-1/2\">\n        <label class=\"font-bold\">Supervisor Contact: </label>\n        {{ newLake.supervisorContact }}\n      </div>\n    </div>\n    <div class=\"flex gap-4 flex-col md:flex-row w-full\">\n      <div class=\"w-full truncate\">\n        <label class=\"font-bold\">Geo Tag: </label>\n        <a :href=\"newLake.geoTag\" class=\"va-link\">\n          {{ newLake.geoTag }}\n        </a>\n      </div>\n    </div>\n    <div class=\"flex gap-4 flex-col md:flex-row w-full\">\n      <div class=\"w-full sm:w-1/2\">\n        <label class=\"font-bold\">Onsite Images: </label>\n        <a @click=\"doShowMediaModal = !doShowMediaModal\">\n          <VaImage\n            class=\"w-full md:w-1/2 lg:w-1/3 hover:cursor-pointer\"\n            :ratio=\"10/9\"\n            src=\"../../../../public/samples/sample-image1.jpg\"\n          />\n          <div class=\"hover:cursor-pointer\">5 items</div>\n        </a>\n      </div>\n    </div>\n    <VaModal\n      v-slot=\"{ cancel, ok }\"\n      v-model=\"doShowMediaModal\"\n      fullscreen\n      close-button\n      hide-default-actions\n      :noOutsideDismiss=\"true\"\n    >\n      <viewer :images=\"images\" class=\"flex\">\n        <img v-for=\"src in images\" :key=\"src\" :src=\"src\" class=\"w-36 px-2\">\n      </viewer>\n      <!-- <VaImage src=\"/samples/sample-image1.jpg\" alt=\"\" /> -->\n    </VaModal>\n  </div>\n</template>\n","<script setup lang=\"ts\">\nimport { PropType, computed, ref, watch } from 'vue'\nimport { useForm } from 'vuestic-ui'\nimport { Lake } from '../types'\nimport { Checklist } from '../../checklist/types'\nimport UserAvatar from './UserAvatar.vue'\nimport { useProjects } from '../../projects/composables/useProjects'\nimport { validators } from '../../../services/utils'\n\nconst checklist: Checklist = {\n    fs: true,\n    ss: true,\n    wsi: true,\n    prc: false,\n    ha: false,\n    cg: false,\n    ec: false,\n    ls: false,\n    fwm: false,\n    sd: false,\n    mm: false\n}\n\nconst newChecklist = ref<Checklist>({ ...checklist })\n\nconst totalChecklist = Object.keys(newChecklist.value).length\n\nlet progress = ref(0)\n\nconst countDone = () => {\n  progress.value = 0\n    Object.keys(newChecklist.value).map((key) => {\n    if (newChecklist.value[key]) {\n      progress.value++\n    }\n  })\n}\ncountDone()\n\nwatch(newChecklist.value, () => {\n  countDone()\n},\n{ deep: true })\n\n\n</script>\n\n<template>\n  <div class=\"flex flex-col md:flex-row\">\n    <div class=\"flex w-full md:w-1/2 justify-center mb-10\">\n      <ve-progress :progress=\"((progress / totalChecklist) * 100).toFixed(1)\">\n        {{ ((progress / totalChecklist) * 100).toFixed(1) }}%\n      </ve-progress>\n    </div>\n    <div class=\"flex flex-col\">\n      <VaCheckbox\n        v-model=\"newChecklist.fs\"\n        label=\"Feasibility Study\"\n        class=\"mb-6\"\n      />\n      <VaCheckbox\n        v-model=\"newChecklist.ss\"\n        label=\"Site Selection\"\n        class=\"mb-6\"\n      />\n      <VaCheckbox\n        v-model=\"newChecklist.wsi\"\n        label=\"Water Source Identificaiton\"\n        class=\"mb-6\"\n      />\n      <VaCheckbox\n        v-model=\"newChecklist.prc\"\n        label=\"Permitting and Regulatory Compliance\"\n        class=\"mb-6\"\n      />\n      <VaCheckbox\n        v-model=\"newChecklist.ha\"\n        label=\"Hydrological Assessment\"\n        class=\"mb-6\"\n      />\n      <VaCheckbox\n        v-model=\"newChecklist.cg\"\n        label=\"Clearing and Grading\"\n        class=\"mb-6\"\n      />\n      <VaCheckbox\n        v-model=\"newChecklist.ec\"\n        label=\"Excavation and Construction\"\n        class=\"mb-6\"\n      />\n      <VaCheckbox\n        v-model=\"newChecklist.ls\"\n        label=\"Lining and Sealing\"\n        class=\"mb-6\"\n      />\n      <VaCheckbox\n        v-model=\"newChecklist.fwm\"\n        label=\"Filling and Water Management\"\n        class=\"mb-6\"\n      />\n      <VaCheckbox\n        v-model=\"newChecklist.sd\"\n        label=\"Shoreline Development\"\n        class=\"mb-6\"\n      />\n      <VaCheckbox\n        v-model=\"newChecklist.mm\"\n        label=\"Monitoring and Maintenance\"\n      />\n    </div>\n  </div>\n</template>\n","<script setup lang=\"ts\">\nimport { ref } from 'vue'\nimport LakesTable from './widgets/LakesTable.vue'\nimport LakeDetails from './widgets/LakeDetails.vue'\nimport LakeChecklist from './widgets/LakeChecklist.vue'\nimport { Lake } from './types'\nimport { useLakes } from './composables/useLakes'\nimport { useModal, useToast } from 'vuestic-ui'\n\nconst doShowEditUserModal = ref(false)\n\nconst { lakes, isLoading, filters, sorting, pagination, ...usersApi } = useLakes()\n\nconst userToEdit = ref<Lake | null>(null)\n\nconst showEditUserModal = (lake: Lake) => {\n  userToEdit.value = lake\n  doShowEditUserModal.value = true\n}\n\nconst showAddUserModal = () => {\n  userToEdit.value = null\n  doShowEditUserModal.value = true\n}\n\nconst { init: notify } = useToast()\n\nconst onUserSaved = async (lake: Lake) => {\n  if (userToEdit.value) {\n    await usersApi.update(lake)\n    notify({\n      message: `${lake.englishName} has been updated`,\n      color: 'success',\n    })\n  } else {\n    usersApi.add(lake)\n    notify({\n      message: `${lake.englishName} has been created`,\n      color: 'success',\n    })\n  }\n}\n\nconst onUserDelete = async (lake: Lake) => {\n  await usersApi.remove(lake)\n  notify({\n    message: `${lake.englishName} has been deleted`,\n    color: 'success',\n  })\n}\n\nconst editFormRef = ref()\n\nconst { confirm } = useModal()\n\nconst beforeEditFormModalClose = async (hide: () => unknown) => {\n  if (editFormRef.value.isFormHasUnsavedChanges) {\n    const agreed = await confirm({\n      maxWidth: '380px',\n      message: 'Form has unsaved changes. Are you sure you want to close it?',\n      size: 'small',\n    })\n    if (agreed) {\n      hide()\n    }\n  } else {\n    hide()\n  }\n}\n</script>\n\n<template>\n  <h1 class=\"page-title\">Lake Details</h1>\n\n  <VaCard class=\"mb-3\">\n    <VaCardTitle>Lake Information</VaCardTitle>\n    <VaCardContent>\n      <LakeDetails\n        ref=\"editFormRef\"\n      />\n    </VaCardContent>\n  </VaCard>\n\n  <VaCard>\n    <VaCardTitle>Lake Checklist</VaCardTitle>\n    <VaCardContent>\n      <LakeChecklist\n        ref=\"lakeChecklistRef\"\n      />\n    </VaCardContent>\n  </VaCard>\n</template>\n"],"names":["props","__props","doShowMediaModal","ref","defaultNewLake","images","newLake","isFormHasUnsavedChanges","computed","key","_a","__expose","watch","avatar","makeAvatarBlobUrl","newAvatar","useForm","useProjects","newChecklist","totalChecklist","progress","countDone","useLakes","useToast","editFormRef","useModal"],"mappings":"uvEAQA,MAAMA,EAAQC,EAWRC,EAAmBC,EAAI,EAAK,EAE5BC,EAAuB,CAC3B,GAAI,EACJ,YAAa,SACb,WAAY,CAAC,EACb,OAAQ,kKACR,aAAc,UACd,QAAS,YACT,WAAY,aACZ,QAAS,aACT,UAAW,iBACX,QAAS,qBACT,SAAU,SACV,YAAa,kBACb,mBAAoB,cACpB,WAAY,YACZ,kBAAmB,cACnB,GAAI,GACJ,GAAI,GACJ,IAAK,GACL,IAAK,GACL,GAAI,GACJ,GAAI,GACJ,GAAI,GACJ,GAAI,GACJ,IAAK,GACL,GAAI,GACJ,GAAI,EAAA,EAGAC,EAAS,CACb,6BACA,6BACA,6BACA,6BACA,4BAAA,EAGIC,EAAUH,EAAU,CAAE,GAAGC,CAAgB,CAAA,EAEzCG,EAA0BC,EAAS,IAChC,OAAO,KAAKF,EAAQ,KAAK,EAAE,KAAMG,GAAQ,OAC1C,OAAAA,IAAQ,UAAYA,IAAQ,WACvB,GAGFH,EAAQ,MAAMG,CAAiB,MAAOC,EAAAV,EAAM,MAAQI,IAAd,YAAAM,EAAgCD,GAAiB,CAC/F,CACF,EAEYE,EAAA,CACX,wBAAAJ,CAAA,CACD,EAEDK,EACE,IAAMZ,EAAM,KACZ,IAAM,CACCA,EAAM,OAIX,QAAQ,MAAQ,CACd,GAAGA,EAAM,KACT,OAAQA,EAAM,KAAK,QAAU,EAAA,EAEjC,EACA,CAAE,UAAW,EAAK,CAAA,EAGpB,MAAMa,EAASV,IAETW,EAAqBD,GAClB,IAAI,gBAAgBA,CAAM,EAG7B,OAAAD,EAAAC,EAASE,GAAc,CAC3B,QAAQ,MAAM,OAASA,EAAYD,EAAkBC,CAAS,EAAI,EAAA,CACnE,EAEYC,EAAQ,eAAe,EAgBfC,EAAY,CAAE,WAAYd,EAAI,CAAE,KAAM,EAAG,QAAS,KAAM,MAAO,EAAG,CAAC,EAAG,6/CC5F3F,MAAMe,EAAef,EAAe,CAAE,GAdT,CACzB,GAAI,GACJ,GAAI,GACJ,IAAK,GACL,IAAK,GACL,GAAI,GACJ,GAAI,GACJ,GAAI,GACJ,GAAI,GACJ,IAAK,GACL,GAAI,GACJ,GAAI,EAAA,CAG4C,CAAA,EAE9CgB,EAAiB,OAAO,KAAKD,EAAa,KAAK,EAAE,OAEnD,IAAAE,EAAWjB,EAAI,CAAC,EAEpB,MAAMkB,EAAY,IAAM,CACtBD,EAAS,MAAQ,EACf,OAAO,KAAKF,EAAa,KAAK,EAAE,IAAKT,GAAQ,CACzCS,EAAa,MAAMT,CAAG,GACfW,EAAA,OACX,CACD,CAAA,EAEO,OAAAC,IAEVT,EAAMM,EAAa,MAAO,IAAM,CACpBG,GACZ,EACA,CAAE,KAAM,EAAK,CAAA,84DCjCelB,EAAI,EAAK,EAEmCmB,EAAS,EAE9DnB,EAAiB,IAAI,EAYfoB,EAAS,EA0BlC,MAAMC,EAAcrB,IAEA,OAAAsB,EAAS"}